---
 
- hosts: all
  become: true
  tasks:

  - name: update repository index
    apt:
      update_cache: yes

  - name: upgrade all packages
    apt:
      name: "*"
      state: latest

- hosts: docker
  become: true
  tasks:

  - name: update docker containers in multimedia stack
    community.general.docker_compose:
      project_src: /mnt/docker/multimedia
      pull: yes
      build: no

  - name: update docker containers in bitwarden stack
    community.general.docker_compose:
      project_src: /mnt/docker/bitwarden
      pull: yes
      build: no

  - name: update docker containers in grafana stack
    community.general.docker_compose:
      project_src: /mnt/docker/grafana
      pull: yes
      build: no

  - name: update docker containers in openspeedtest stack
    community.general.docker_compose:
      project_src: /mnt/docker/openspeedtest
      pull: yes
      build: no

  - name: update docker containers in scrutiny stack
    community.general.docker_compose:
      project_src: /mnt/docker/scrutiny
      pull: yes
      build: no

  - name: update docker containers in telegraf stack
    community.general.docker_compose:
      project_src: /mnt/docker/telegraf
      pull: yes
      build: no

  - name: update docker containers in ubooquity stack
    community.general.docker_compose:
      project_src: /mnt/docker/ubooquity
      pull: yes
      build: no

  - name: update docker containers in unifi-controller stack
    community.general.docker_compose:
      project_src: /mnt/docker/unifi-controller
      pull: yes
      build: no

  - name: update docker containers in wireguard stack
    community.general.docker_compose:
      project_src: /mnt/docker/wireguard
      pull: yes
      build: no
